<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>InertiaX</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body { background:#f7f7f7; }
</style>
</head>
<body>

<div class="container mt-5">
<h1 class="text-center">ğŸ‹ï¸â€â™‚ï¸ InertiaX</h1>
<p class="text-center">AnÃ¡lisis deportivo con IA</p>

<form id="uploadForm">
<input class="form-control mb-2" type="text" name="nombre_entrenador" placeholder="Entrenador" required>
<input class="form-control mb-2" type="text" name="nombre_cliente" placeholder="Atleta" required>
<input class="form-control mb-2" type="file" name="file" required>

<button class="btn btn-primary w-100">Subir archivo</button>
</form>

<div id="status" class="mt-3 text-center"></div>

</div>

<script>
document.getElementById("uploadForm").addEventListener("submit", async(e)=>{
e.preventDefault();

const fd = new FormData(uploadForm);
const res = await fetch("/upload", {method:"POST", body:fd});
const data = await res.json();

check(data.job_id);
});

async function check(id){
const status = document.getElementById("status");
status.innerHTML = "Procesando...";

const timer = setInterval(async()=>{
    const r = await fetch("/status/"+id);
    const s = await r.json();

    if(s.status === "completed"){
        clearInterval(timer);
        status.innerHTML = "Completado âœ… descargando...";
        window.location = "/download/"+id;
    }

    if(s.status === "error"){
        clearInterval(timer);
        status.innerHTML = "Error: "+s.error;
    }
}, 2000);
}
</script>
</body>
</html>
